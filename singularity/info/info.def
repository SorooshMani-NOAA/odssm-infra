BootStrap: docker
From: continuumio/miniconda3:24.3.0-0

%files
    environment.yml 
    files/hurricane_data.py /scripts/

%environment
    export PYTHONPATH=/scripts

%post
    apt update && apt upgrade -y  && apt install -y git

    conda install mamba -n base -c conda-forge 
    conda install libarchive -n base -c conda-forge
    mamba update --name base --channel defaults conda 
    mamba env create -n info --file /environment.yml
    mamba clean --all --yes

    conda run -n info --no-capture-output \
        pip install stormevents==2.2.3


    conda clean --all
    apt remove -y git


%runscript
    conda run -n info --no-capture-output python -m $*


%labels
    Author "Soroosh Mani"
